{
  "IssueID": 1125,
  "VulnerabilityID": "CVE-2012-2111",
  "Release": "2.2",
  "Package": "samba",
  "Repository": "main",
  "FixedVersion": "3.5.15-r0",
  "Subject": "[v2.2] samba\u003c3.5.15: Incorrect permission checks (CVE-2012-2111)",
  "Description": "h2. Description\r\n\r\nSamba versions 3.4.x to 3.6.4 inclusive are affected by a\r\nvulnerability that allows arbitrary users to modify privileges on a\r\nfile server.\r\n\r\nSecurity checks were incorrectly applied to the Local Security\r\nAuthority (LSA) remote proceedure calls (RPC) CreateAccount,\r\nOpenAccount, AddAccountRights and RemoveAccountRights allowing any\r\nauthenticated user to modify the privileges database.\r\n\r\nThis is a serious error, as it means that authenticated users can\r\nconnect to the LSA and grant themselves the \"take ownership\"\r\nprivilege. This privilege is used by the smbd file server to grant the\r\nability to change ownership of a file or directory which means users\r\ncould take ownership of files or directories they do not own.\r\n\r\nh2. Patch Availability\r\n\r\nPatches addressing this issue have been posted to:\r\n\r\n    http://www.samba.org/samba/security/\r\n\r\nAdditionally, Samba 3.6.5, Samba 3.5.15 and 3.4.17 have been issued as\r\nsecurity releases to correct the defect. Patches against older Samba\r\nversions are available at:\r\n\r\n    http://samba.org/samba/patches/\r\n\r\nSamba administrators running affected versions are advised to upgrade\r\nto 3.6.5, 3.5.15, or 3.4.17 or apply these patches as soon as\r\npossible.\r\n\r\nh2. Workaround\r\n\r\nImmediately set the \"enable privileges = no\" parameter in the [global]\r\nsection of the smb.conf. This will prevent any further use of granted\r\nprivileges on the file server and protect from compromise.\r\n\r\nTo remove any incorrectly granted privileges, remove the file:\r\n\r\naccount_policy.tdb\r\n\r\nfrom your system, and once the patch is applied re-grant specified\r\nuser privileges using the \"net rpc rights\" command.\r\n\r\nh2. Credits\r\n\r\nThis vulnerability was reported by Ivano Cristofolini. Many thanks to\r\nhim for reporting this promptly.\r\n\r\nPatches were created by Jeremy Allison of the Samba Team, and reviewed\r\nby Guenther Deschner of the Samba Team, the SUSE Security Team, and\r\nTyler Hicks of Canonical.\r\n\r\nh2. Reference\r\n\r\nhttp://www.samba.org/samba/security/CVE-2012-2111\r\n\r\n"
}