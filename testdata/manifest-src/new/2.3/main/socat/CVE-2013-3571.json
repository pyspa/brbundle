{
  "IssueID": 2011,
  "VulnerabilityID": "CVE-2013-3571",
  "Release": "2.3",
  "Package": "socat",
  "Repository": "main",
  "FixedVersion": "1.7.2.2-r0",
  "Subject": "[v2.3] socat  1.2.0.0 - 1.7.2.1, 2.0.0-b1 - 2.0.0-b5  (CVE-2013-3571)",
  "Description": "Overview\r\n  Under certain circumstances an FD leak occurs and can be misused for\r\n  denial of service attacks against socat running in server mode.\r\n\r\nVulnerability Id: CVE-2013-3571\r\n\r\nDetails\r\n  The issue occurs when a vulnerable version of socat is invoked with a\r\n  listen type address with option fork and one or more of the options\r\n  sourceport, lowport, range, or tcpwrap. When socat refuses a client\r\n  connection due to one of these address or port restrictions it does\r\n  shutdown() the socket but does not close() it, resulting in a file\r\n  descriptor leak in the listening process, visible with command lsof\r\n  and possibly resulting in error EMFILE \"Too many open files\".\r\n\r\nTestcase\r\n  In one terminal run the server:\r\n\r\n    socat -d tcp-listen:10000,reuseaddr,fork,range=0.0.0.0/32 pipe\r\n\r\n  In a second terminal see which FDs are open, then connect (implicitely\r\n  using a forbidden address), and check if there is a new FD open, e.g.:\r\n\r\n    lsof -p $(pgrep socat)\r\n    socat /dev/null tcp:localhost:10000\r\n    lsof -p $(pgrep socat)\r\n\r\n  If the second lsof shows an additional FD as in the following line,\r\n  this socat version is vulnerable:\r\n\r\n    socat  17947 gerhard  4u  sock  0,6  0t0 1145265 can't identify protocol\r\n\r\nWorkaround\r\n  Use IP filters in your OS or firewall.\r\n  Restart socat when it crashed.\r\n\r\nAffected versions\r\n  1.2.0.0 - 1.7.2.1\r\n  2.0.0-b1 - 2.0.0-b5\r\n\r\nNot affected or corrected versions\r\n  1.0.0.0 - 1.1.0.1\r\n  1.7.2.2 and later\r\n  2.0.0-b6 and later\r\n\r\nDownload\r\n  The updated sources can be downloaded from:\r\n\r\n    http://www.dest-unreach.org/socat/download/socat-1.7.2.2.tar.gz\r\n    http://www.dest-unreach.org/socat/download/socat-2.0.0-b6.tar.gz\r\n\r\n  Patch to 1.7.2.1:\r\n    http://www.dest-unreach.org/socat/download/socat-1.7.2.2.patch.gz\r\n\r\n  Patch to 2.0.0-b5:\r\n    http://www.dest-unreach.org/socat/download/socat-2.0.0-b6.patch.gz\r\n\r\nCredits\r\n  Full credits to Catalin Mitrofan for finding and reporting this issue."
}